<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta charset="UTF-8" />
<title>测试多格式</title>
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js" type="text/javascript"></script>
<script src="https://cdn.bootcss.com/jspdf/1.5.3/jspdf.min.js" type="text/javascript"></script>
<script src="https://cdn.bootcss.com/html2canvas/0.5.0-alpha2/html2canvas.min.js" type="text/javascript"></script>
</head>
<body>

<script type="text/javascript">
function download(){
	 var element = $("#demo"); // 这个dom元素是要导出pdf的div容器
	 var w = element.width(); // 获得该容器的宽
	 var h = element.height(); // 获得该容器的高
	 var offsetTop = element.offset().top; // 获得该容器到文档顶部的距离
	 var offsetLeft = element.offset().left; // 获得该容器到文档最左的距离
	 var canvas = document.createElement("canvas");
	 var abs = 0;
	 var win_i = $(window).width(); // 获得当前可视窗口的宽度（不包含滚动条）
	 var win_o = window.innerWidth; // 获得当前窗口的宽度（包含滚动条）
	 if(win_o>win_i){
	  abs = (win_o - win_i)/2; // 获得滚动条长度的一半
	 }
	 canvas.width = w * 2; // 将画布宽&&高放大两倍
	 canvas.height = h * 2;
	 var context = canvas.getContext("2d");
	 context.scale(2, 2);
	 context.translate(-offsetLeft-abs,-offsetTop); 
	 // 这里默认横向没有滚动条的情况，因为offset.left(),有无滚动条的时候存在差值，因此  
	 // translate的时候，要把这个差值去掉
	 html2canvas(element).then(function(canvas) {
	 var contentWidth = canvas.width;
	 var contentHeight = canvas.height;
	 //一页pdf显示html页面生成的canvas高度;
	 var pageHeight = contentWidth / 592.28 * 841.89;
	 //未生成pdf的html页面高度
	 var leftHeight = contentHeight;
	 //页面偏移
	 var position = 0;
	 //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高
	 var imgWidth = 595.28;
	 var imgHeight = 592.28/contentWidth * contentHeight;
	 
	 var pageData = canvas.toDataURL('image/jpeg', 1.0);
	 
	 var pdf = new jsPDF('', 'pt', 'a4');
	 
	 //有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)
	 //当内容未超过pdf一页显示的范围，无需分页
	 if (leftHeight < pageHeight) {
	 pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight);
	 } else { // 分页
	  while(leftHeight > 0) {
	   pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
	   leftHeight -= pageHeight;
	   position -= 841.89;
	   //避免添加空白页
	   if(leftHeight > 0) {
	    pdf.addPage();
	   }
	  }
	 }
	 pdf.save('我的简历.pdf');  
	 })
	}
    </script>
    
	<!-- 头部 -->
	<input type="button" name ="转换" value="pdf" onclick="download()"/>
	<div id ="demo">
	<div style='text-align: center;background-color:#ffffff'>
		<div id='ZhuBanDanWei' style='font-size: 60px; color: red;font-family:STSong' />
		<b>国家铁路局信息中心</b>
	</div>
	<img src='../AppTLJ/PrintTemplate/LineTop.png' style='width: 90%; height: 10px;' />

	<center>

		<table style='text-align: center; width: 90%;' bgcolor="#ffffff">
			<tr>
				<td style='text-align: center'>
					<!-- 标题 -->
					<div id='BiaoTi' style='font-size: 50px;  width: 90%;'>
						测试多格式</div>
				</td>
			</tr>

			<tr>
				<td style='text-align: left'>
					<!-- 正文内容 -->
					<div id="ZhengWenNeiRong"
						style='font-size: 30px; width: 100%;'>
						<span style="LAYOUT-GRID:15.6pt none"><span style="FONT-SIZE:16pt"><span style="FONT-FAMILY:黑体">信息中心，机关各部门：</span></span><br />
<span style="BACKGROUND:white"><span style="LINE-HEIGHT:29pt"><span style="FONT-SIZE:16pt"><span style="FONT-FAMILY:仿宋_GB2312">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 为进一步完善国家铁路局政府信息公开工作机制、规范内部工作流程，根据《中华人民共和国政府信息公开条例》、《国家铁路局政府信息公开实施办法（暂行）》和《国家铁路局政府网站建设管理暂行办法》，结合我局组建履职以来政府信息公开工作实践，我们起草了《国家铁路局政府信息公开内部工作程序规定》（征求意见稿），请你们提出意见，并于2月16日前将花脸稿反馈至综合司秘书处。</span></span></span></span><br />
&nbsp;&nbsp; <span style="BACKGROUND:white"><span style="LINE-HEIGHT:29pt"><span style="FONT-SIZE:16pt"><span style="FONT-FAMILY:仿宋_GB2312">为进一步完善国家铁路局政府信息公开工作机制、规范内部工作流程，根据《中华人民共和国政府信息公开条例》、《国家铁路局政府信息公开实施办法（暂行）》和《国家铁路局政府网站建设管理暂行办法》，结合我局组建履职以来政府信息公开工作实践，我们起草了《国家铁路局政府信息公开内部工作程序规定》（征求意见稿），请你们提出意见，并于2月16日前将花脸稿反馈至综合司秘书处。<br />
为进一步完善国家铁路局政府信息公开工作机制、规范内部工作流程，根据《中华人民共和国政府信息公开条例》、《国家铁路局政府信息公开实施办法（暂行）》和《国家铁路局政府网站建设管理暂行办法》，结合我局组建履职以来政府信息公开工作实践，我们起草了《国家铁路局政府信息公开内部工作程序规定》（征求意见稿），请你们提出意见，并于2月16日前将花脸稿反馈至综合司秘书处。<br />
<strong>为进一步完善国家铁路局政府信息公开工作机制、规范内部工作流程，根据《中华人民共和国政府信息公开条例》、《国家铁路局政府信息公开实施办法（暂行）》和《国家铁路局政府网站建设管理暂行办法》，结合我局组建履职以来政府信息公开工作实践，我们起草了《国家铁路局政府信息公开</strong>内部工作程序规定》（征求意见稿），请你们提出意见，并于2月16日前将花脸稿反馈至综合司秘书处。<br />
为进一步完善国家铁路局政府信息公开工作机制、规范内部工作流程，根据《中华人民共和国政府信息公开条例》、《国家铁路局政府信息公开实施办法（暂行）》和《国家铁路局政府网站建设管理暂行办法》，结合我局组建履职以来政府信息公开工作实践，我们起草了《国家<u>铁路局政府信息公开内部工作程序规定》（征求意见稿），请你们提出意见，并于2月16日</u>前将花脸稿反馈至综合司秘书处。<br />
<em><strong>为进一步完善国家铁路局政府信息公开工作机制、规范内部工作流程，根据《中华人民共和国政府信息公开条例》、《国家铁路局政府信息公开实施办法（暂行）》和《国家铁路局政府网站建设管理暂行办法》，结合我局组建履职以来政府信息公开工作实践，我们起草了《国家铁路局政府信息公开内部工作程序规定》（征求意见稿），请你们提出意见，并于2月16日前将花脸稿反馈至综合司秘书处。</strong></em></span></span></span></span><br />
<span style="BACKGROUND:white"><span style="LINE-HEIGHT:29pt"><span style="FONT-SIZE:16pt"><span style="FONT-FAMILY:仿宋_GB2312">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 联系人：谢文广；<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 联系电话：97591。</span></span></span></span><br />
<br />
<br />
<span style="BACKGROUND:white"><span style="LINE-HEIGHT:29pt"><span style="FONT-SIZE:16pt"><span style="FONT-FAMILY:仿宋_GB2312">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 综合司</span></span></span></span><br />
<span style="BACKGROUND:white"><span style="LINE-HEIGHT:29pt"><span lang="EN-US" style="FONT-SIZE:16pt"><span style="FONT-FAMILY:仿宋_GB2312">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2015</span></span><span style="FONT-SIZE:16pt"><span style="FONT-FAMILY:仿宋_GB2312">年2月11日</span></span></span></span></span></div>
				</td>
			</tr>
		</table>
	</center>

	<!-- 页脚 -->
	<footer>
	<div style='text-align: center'>
	<img src='../AppTLJ/PrintTemplate/LineEnd.png' style='width: 90%; height: 10px;' />
		 
		 <br/>
		 <br/>
	</div>
	</footer>
</div>

</body>
</html>