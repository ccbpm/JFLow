<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>集成跳转页面</title>
    <script src="../Scripts/jquery-1.11.0.min.js" type="text/javascript"></script>
     <!-- 引用通用的js文件. -->
    <script type="text/javascript" src="../Scripts/config.js?v=1.0"></script>
    <script type="text/javascript" src="../Comm/Gener.js?v=1.0"></script>
    <script src="../Scripts/QueryString.js" type="text/javascript"></script>
	<script type="text/javascript" src="http://g.alicdn.com/dingding/open-develop/1.9.0/dingtalk.js"></script>    
	<script type="text/javascript">
    $(function(){
			//集成的平台钉钉、微信
			var type = GetQueryString("state");
			if(type == null || type == undefined || type===""){
				//企业微信回调URL
				var handler = new HttpHandler("BP.WF.HttpHandler.WF_AppClassic");
				handler.AddUrlData();
				var data = handler.DoMethodReturnString("WeiXin_Init");
			}else{
				//微信自动登陆
				var handler = new HttpHandler("BP.WF.HttpHandler.WF_AppClassic");
				handler.AddUrlData();
				var data = handler.DoMethodReturnString("WeiXin_Login");
				if(data.indexOf("err@")!=-1){
					alert(data);
					window.location.href="./Login.htm";
					return;
				}
				toPage(type);//页面跳转
			}
		});
		
		
		//页面启动函数.
        function IsPC() {
            var userAgentInfo = navigator.userAgent;
            var Agents = new Array("Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod");
            var flag = true;
            for (var v = 0; v < Agents.length; v++) {
                if (userAgentInfo.indexOf(Agents[v]) > 0) { flag = false; break; }
            }
            return flag;
        }
		
		function toPage(type){
			//需要判断是PC端APP打开还是移动端App打开(移动端和PC端发布在一起)
			if(IsPC() == true){
				if(type=="Home")
					window.location.href="./Home.htm";
				if(type =="Start")
					window.location.href="../WF/Start.htm";
			}else{
				if(type=="Home")
					window.location.href="../CCMobile/Home.htm";
				if(type =="Start")
					window.location.href="../CCMobile/Start.htm";
			}
		}
    </script>
</head>

<body>
</body>
</html>
